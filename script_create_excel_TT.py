import json
import xlsxwriter

BASE_URL = 'https://datasets.freesound.org'

workbook = xlsxwriter.Workbook('name.xlsx')
worksheet = workbook.add_worksheet('Hyperlinks')
url_format = workbook.add_format({
    'font_color': 'blue',
    'underline':  1
})

id_url = json.load(open('id_url.json'))
ontology = json.load(open('ontology/ontology.json', 'rb'))
ontology_by_id = {o['id']:o for o in ontology}
hierarchy_paths = json.load(open('json/hierarchy_paths.json', 'rb'))

categories = ['/m/02jz0l',
 '/m/0l14qv',
 '/m/07rv9rh',
 '/m/0xzly',
 '/m/03qc9zr',
 '/m/0l14_3',
 '/m/0jb2l',
 '/m/0130jx',
 '/m/06rvn',
 '/m/0261r1',
 '/m/0dwsp',
 '/m/02dgv',
 '/t/dd00037',
 '/m/03dnzn',
 '/m/07st88b',
 '/m/081rb',
 '/m/0bm0k',
 '/m/03v3yw',
 '/m/0l15bq',
 '/m/04s8yn',
 '/m/0mkg',
 '/m/01yrx',
 '/m/01p970',
 '/m/07pn_8q',
 '/m/04zjc',
 '/m/02g901',
 '/m/02zsn',
 '/m/01jnbd',
 '/m/02_nn',
 '/t/dd00031',
 '/m/0242l',
 '/t/dd00129',
 '/m/07pggtn',
 '/m/0dwtp',
 '/m/07pjwq1',
 '/m/0ytgt',
 '/t/dd00005',
 '/m/04brg2',
 '/m/06_fw',
 '/m/0fx9l',
 '/m/05jcn',
 '/m/04_sv',
 '/m/02yds9',
 '/m/03k3r',
 '/m/04cvmfc',
 '/m/07qn4z3',
 '/m/03w41f',
 '/t/dd00033',
 '/m/028ght',
 '/m/07plz5l',
 '/m/012xff',
 '/m/03vt0',
 '/m/03wvsk',
 '/t/dd00013',
 '/m/025_jnm',
 '/m/0lyf6',
 '/m/05_wcq',
 '/m/07ppn3j',
 '/m/0fqfqc',
 '/m/015lz1',
 '/m/02hnl',
 '/m/07pbtc8',
 '/m/020bb7',
 '/m/0bm02',
 '/m/01j423',
 '/m/01gp74',
 '/m/0838f',
 '/m/01lsmm',
 '/m/09xqv',
 '/t/dd00003',
 '/m/0zmy2j9',
 '/m/07s0dtb',
 '/m/01g90h',
 '/m/0642b4',
 '/m/09x0r',
 '/t/dd00128',
 '/m/0ltv',
 '/t/dd00018',
 '/m/02rtxlg',
 '/t/dd00134',
 '/m/016622',
 '/t/dd00126',
 '/m/04szw',
 '/m/03qtq',
 '/m/02pjr4',
 '/t/dd00032',
 '/m/01b_21',
 '/m/09l8g',
 '/m/01j3sz',
 '/m/02_41',
 '/m/068zj',
 '/m/05r5c',
 '/m/09b5t',
 '/m/0463cq4',
 '/m/026t6',
 '/m/06h7j',
 '/m/0btp2',
 '/m/0239kh',
 '/m/0l14md',
 '/m/0dv5r',
 '/m/07rn7sz',
 '/m/07qn5dc',
 '/m/011k_j',
 '/m/01h8n0',
 '/m/0g6b5',
 '/m/07brj',
 '/m/023pjk',
 '/m/01dwxx',
 '/m/0ghcn6',
 '/m/0k65p',
 '/t/dd00135',
 '/m/07rpkh9',
 '/m/053hz1',
 '/m/01jwx6',
 '/m/07r_80w',
 '/m/03qtwd',
 '/m/0939n_',
 '/m/0dwt5',
 '/m/01d3sd',
 '/m/09d5_',
 '/m/07pp_mv',
 '/m/0dl9sf8',
 '/m/0brhx',
 '/m/0c2wf',
 '/m/05rj2',
 '/m/07rkbfh',
 '/m/01jg02',
 '/m/0l14jd',
 '/m/015p6',
 '/m/0d31p',
 '/m/0mbct',
 '/m/06bxc',
 '/m/018w8',
 '/t/dd00001',
 '/m/01jt3m',
 '/m/021wwz',
 '/m/0d8_n',
 '/m/0llzx',
 '/m/0316dw',
 '/t/dd00130',
 '/m/0l14gg',
 '/m/03cczk',
 '/m/07sr1lc',
 '/m/03q5_w',
 '/t/dd00002',
 '/m/01xq0k1',
 '/m/05zppz',
 '/m/03qjg',
 '/m/09ld4',
 '/m/01j4z9',
 '/m/07rjwbb',
 '/m/02k_mr',
 '/m/02bk07',
 '/t/dd00112',
 '/t/dd00127',
 '/m/07qrkrw',
 '/m/0jbk',
 '/m/042v_gx',
 '/t/dd00004',
 '/m/0dxrf',
 '/m/05mxj0q',
 '/m/01hsr_',
 '/m/01b9nn',
 '/m/07p6fty',
 '/m/05r5wn',
 '/m/01z5f',
 '/m/01m2v',
 '/m/02bm9n',
 '/m/0ngt1',
 '/m/05tny_',
 '/m/0j45pbj',
 '/m/07qf0zm',
 '/m/07s0s5r',
 '/m/0bt9lr',
 '/t/dd00071',
 '/m/01s0vc',
 '/m/0cfdd']

categories_with_paths = [(node_id, ' > '.join([ontology_by_id[n]['name'] for n in hierarchy_paths[node_id][0]])) for node_id in categories]

coordinates = ['A'+str(1+x) for x in range(len(categories))]

for idx, category in enumerate(categories_with_paths):
    worksheet.write_url(coordinates[idx], BASE_URL+id_url[category[0]].replace('contribute', 'annotate'), url_format, category[1])

workbook.close()


